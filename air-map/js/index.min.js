!function(){function e(e,n){r=e,i=n,t(),e.on("viewreset moveend",function(e){e&&"viewreset"==e.type&&d3.select("#overlay").remove(),setTimeout(function(){t()},0)})}function t(){d3.select("#overlay").remove(),c=r.getBounds();{var e=r.latLngToLayerPoint(c.getNorthWest());r.latLngToLayerPoint(c.getSouthEast()),d3.set(),c.pad(.4)}a=d3.geo.mercator().center([122.079531,23.978567]).scale(10200),l=d3.geo.path().projection(a),o=d3.select(r.getPanes().overlayPane).append("svg").attr("id","overlay").attr("class","leaflet-zoom-hide").style("width",r.getSize().x+"px").style("height",r.getSize().y+"px").style("margin-left",e.x+"px").style("margin-top",e.y+"px"),s=o.append("g").attr("transform","translate("+-e.x+","+-e.y+")"),n()}function n(){var e=[];i.forEach(function(t){var n=new L.LatLng(+t.TWD97Lat,+t.TWD97Lon);point=r.latLngToLayerPoint(n),e.push(point)});var t=s.attr("class","points").selectAll("g").data(e).enter().append("g").attr("class","point"),n=d3.geom.voronoi().x(function(e){return e.x}).y(function(e){return e.y});n(e).forEach(function(e){e.point.cell=e});var o=function(e){return e.cell?"M"+e.cell.join("L")+"Z":void n([e]).forEach(function(e){return"M"+e.join("L")+"Z"})};t.append("path").attr("class","point-cell").on("click",d).attr("d",o)}module.exports=e;var o,a,l,r,c,s,i=null,d=function(){d3.selectAll(".selected").classed("selected",!1);var e=d3.select(this),t=e.datum();lastSelectedPoint=t,e.classed("selected",!0)}}();