!function n(a,i,r){function t(o,l){if(!i[o]){if(!a[o]){var c="function"==typeof require&&require;if(!l&&c)return c(o,!0);if(e)return e(o,!0);throw new Error("Cannot find module '"+o+"'")}var u=i[o]={exports:{}};a[o][0].call(u.exports,function(n){var i=a[o][1][n];return t(i?i:n)},u,u.exports,n,a,i,r)}return i[o].exports}for(var e="function"==typeof require&&require,o=0;o<r.length;o++)t(r[o]);return t}({1:[function(n,a,i){!function(n){function a(){v=g>5&&18>g?"白天":"晚上",y.child("rain").limitToLast(1).on("child_added",function(n){var a=n.val();d=a,$(".updateAt").text(d[0].PublishTime),$("body").css("background-color","black"),$("canvas").remove(),p={},t(),$(".loading").remove(),$("#layout-header").show()})}function i(a,i,r){var t=document.createElement("img");t.id="background-img",t.crossOrigin="anonymous",document.body.appendChild(t),"rain"===a&&(t.onload=function(){m=new RainyDay({image:this});var a=$(n).width()<680;m.rain(2>r?[[1,3,1e3*r]]:5>r?[[1,5,1e3]]:[[1,8,1e3]]);var i=[[1,3,2]];a||(r>1?i.push([2,3,10]):r>5?i.push([5,10,20]):r>10&&i.push([7,15,20])),1>r||a?m.rain(i,500):5>r?m.rain(i,100/r):10>r?m.rain(i,5):m.rain(i,.5)}),t.src="./images/"+i+v+".jpg"}function r(){$("#background-img")&&($("#background-img").remove(),$("canvas").remove(),m={})}function t(){var a=["Rainfall10min","Rainfall1hr","Rainfall24hr"];d.forEach(function(n){p.hasOwnProperty(n.County)||(p[n.County]={Rainfall10min:0,Rainfall1hr:0,Rainfall24hr:0,Sitenumber:0}),p[n.County].Sitenumber+=1;for(var i in a)"Sitenumber"!==a[i]&&(p[n.County][a[i]]+=parseFloat(n[a[i]]))});for(var i in p)for(var r in a)p[i][a[r]]=(p[i][a[r]]/p[i].Sitenumber).toFixed(2);var t=n.location.hash,o=t.substring(t.indexOf("#")+1);o in p?h({id:o}):e(p)}function e(n){var a=0,t=0;r(),b.forEach(function(i){$(".mychart").append('<div class="raindrop" id="'+i+'"><h3>'+i+"</h3><h6>10分鐘平均累積雨量<br/>"+l(n[i].Rainfall10min)+"</h6><h6>1小時平均累積雨量<br/>"+l(n[i].Rainfall1hr)+"</h6><h6>日平均累積雨量<br/>"+l(n[i].Rainfall24hr)+'</h6><a href="#title" class="btn-more" onClick=showDetail('+i+")>點擊觀看</a></div>"),0!==Math.round(10*n[i].Rainfall1hr)&&(c("#"+i,u(n[i].Rainfall10min,n[i].Rainfall24hr)),a+=1,n[i].Rainfall10min>t&&(t=n[i].Rainfall10min)),o("#"+i)}),a>4||t>=2?i("rain","",t):i("sunny","")}function o(n){var a=$(n).width(),i=$(n).height(),r=d3.select(n).append("svg").attr("width",a).attr("height",i).attr("position","absolute"),t=d3.scale.linear().range([i,0]).domain([0,500]),e=d3.svg.axis().scale(t).orient("left").ticks(5);r.append("g").attr("class","axis").attr("transform","translate(30,0)").call(e)}function l(n){return n>0?'<span class="red">'+n+"</span>":n}function c(n,a){a=a||{};$(n).raindrops(a)}function u(n,a){var i,r=a,t="rgb(23, 139, 202)",e=40,o=400;return 1>n?i=5*n:5>n?(t="rgb(23, 139, 202)",i=10*n/5):10>n?(t="rgb(23, 139, 202)",o=200,i=15*n/10,e=80):15>n?(t="#f2711c",o=200,i=20*n/15,e=90):20>n?(t="#f2711c",o=200,e=90,i=25*n/20):(t="#DB2828",i=30,o=180,e=100,$("span").removeClass("red")),r>500&&(r=500),{color:t,waveLength:o,frequency:i,waveHeight:e,density:.04,canvasHeight:r}}function h(n){var a=[];d.forEach(function(i){i.County===n.id&&a.push(i)}),$(".mychart").empty(),s(a)}function s(a){var t=0,e=0;r(),a.forEach(function(n){var a=n.SiteName.replace(/[()]/g,"-");$(".mychart").append('<div class="raindrop" id="A'+n.SiteId+'"><h3 class="sitename">'+a+"（"+n.Township+"）</h3><h6>10分鐘累積雨量<br/>"+l(n.Rainfall10min)+"</h6><h6>1小時累積雨量<br/>"+l(n.Rainfall1hr)+"</h6><h6>日累積雨量<br/>"+l(n.Rainfall24hr)+'</h6><a href="#'+n.County+'" class="btn-back" onClick=goBack()>返回</a></div>'),0!==Math.round(10*n.Rainfall1hr)&&(c("#A"+n.SiteId,u(n.Rainfall10min,n.Rainfall24hr)),t+=1,n.Rainfall10min>e&&(e=n.Rainfall10min)),o("#A"+n.SiteId)});var h=1*a.length/4;t>h||e>2?i("rain",a[0].County,e):i("sunny",a[0].County),setTimeout(function(){n.location.hash=a[0].County},1e3)}function f(){$(".mychart").empty(),e(p),setTimeout(function(){n.location.hash=""},1e3)}n.showDetail=h,n.goBack=f;var d,m,v,p={},g=(new Date).getHours(),b=["基隆市","臺北市","新北市","桃園市","新竹市","新竹縣","苗栗縣","臺中市","彰化縣","南投縣","雲林縣","嘉義市","嘉義縣","臺南市","高雄市","屏東縣","宜蘭縣","花蓮縣","臺東縣","連江縣","金門縣","澎湖縣"],y=new Firebase("https://realtaiwanstat3.firebaseio.com");a()}(window)},{}]},{},[1]);