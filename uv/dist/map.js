!function t(n,e,o){function r(a,c){if(!e[a]){if(!n[a]){var l="function"==typeof require&&require;if(!c&&l)return l(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var s=e[a]={exports:{}};n[a][0].call(s.exports,function(t){var e=n[a][1][t];return r(e?e:t)},s,s.exports,t,n,e,o)}return e[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(t,n,e){!function(){function n(t,n){$(".updateAt").text("更新時間："+t[0].PublishTime+"（每小時更新）");for(var o in t){var r,i=e(t[o].UVI);r="yellow"==i.color?u:L.AwesomeMarkers.icon({prefix:"fa",icon:"map-marker",markerColor:i.color});var a=(Object.keys(t[o]),t[o].SiteName),c=n[a];t[o].TWD97Lat=c.lat,t[o].TWD97Lon=c.lng;var s=L.marker([t[o].TWD97Lat,t[o].TWD97Lon],{icon:r,opacity:.9}).addTo(l);s.bindPopup("<strong>測站名稱："+t[o].SiteName+'</strong><br/><span class="'+i.color+'">紫外線指數分級：'+i.disc+"</span><br/>紫外線指數："+t[o].UVI+"<br/>縣市："+t[o].County)}d3Initialize(l,t)}function e(t){return 2>=t?{disc:"低量級",color:"green"}:5>=t?{disc:"中量級",color:"yellow"}:7>=t?{disc:"高量級",color:"orange"}:10>=t?{disc:"過量級",color:"red"}:{disc:"危險級",color:"purple"}}function o(){l=new L.Map("map"),url="http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png",attrib='&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>';var t=new L.TileLayer(url,{minZoom:1,maxZoom:16,attribution:attrib});l.setView(new L.LatLng(24,121),7),t.addTo(l),d.addTo(l),p.addTo(l)}function r(){return navigator.geolocation?navigator.geolocation.getCurrentPosition(i):void 0}function i(t){l.setView(new L.LatLng(t.coords.latitude,t.coords.longitude),10)}function a(){l.setView(new L.LatLng(24,121),7)}function c(){s?$(".main-info").hide():$(".main-info").show(),s=!s}d3Initialize=t("./index");var l,s,d=L.control(),u=L.icon({iconUrl:"./images/yellow.png",iconSize:[35,45],iconAnchor:[17,42],popupAnchor:[0,-35]});window.getLocation=r,window.resetView=a,window.toogleInfo=c,$(document).ready(function(){o();var t="http://api.taiwanstat.com:3000/uvs/latest";d3.json(t,function(t){d3.json("./data/locations.json",function(e){n(t,e)})})}),d.onAdd=function(t){return this._div=L.DomUtil.create("div","info"),this._div.innerHTML="<h4>格狀區塊：表示該區域內最近的測站</h4>",this._div};var p=L.control({position:"bottomright"});p.onAdd=function(t){for(var n=L.DomUtil.create("div","info legend"),e=["#E062C8","#F52305","#F7931C","yellow","#7FB73A"],o=["危險級","過量級","高量級","中量級","低量級"],r=0;r<o.length;r++)n.innerHTML+='<i style="background:'+e[r]+'"></i>'+o[r]+"<br/>";return n}}()},{"./index":2}],2:[function(t,n,e){!function(){function t(){queue().await(r)}function e(t,n){s=t,f=n,o(),t.on("viewreset moveend",function(t){t&&"viewreset"==t.type&&d3.select("#overlay").remove(),setTimeout(function(){o()},0)})}function o(){d3.select("#overlay").remove(),d=s.getBounds();{var n=s.latLngToLayerPoint(d.getNorthWest());s.latLngToLayerPoint(d.getSouthEast()),d3.set(),d.pad(.4)}c=d3.geo.mercator().center([122.079531,23.978567]).scale(10200),l=d3.geo.path().projection(c),a=d3.select(s.getPanes().overlayPane).append("svg").attr("id","overlay").attr("class","leaflet-zoom-hide").style("width",s.getSize().x+"px").style("height",s.getSize().y+"px").style("margin-left",n.x+"px").style("margin-top",n.y+"px"),u=a.append("g").attr("transform","translate("+-n.x+","+-n.y+")"),p?i():t()}function r(t,n){p=n,i()}function i(){var t=[];f.forEach(function(n){var e=new L.LatLng(+n.TWD97Lat,+n.TWD97Lon);point=s.latLngToLayerPoint(e),t.push(point)});var n=u.attr("class","points").selectAll("g").data(t).enter().append("g").attr("class","point"),e=d3.geom.voronoi().x(function(t){return t.x}).y(function(t){return t.y});e(t).forEach(function(t){t.point.cell=t});var o=function(t){return"M"+t.cell.join("L")+"Z"};n.append("path").attr("class","point-cell").on("click",g).attr("d",o)}n.exports=e;var a,c,l,s,d,u,p=null,f=null,g=function(){d3.selectAll(".selected").classed("selected",!1);var t=d3.select(this),n=t.datum();lastSelectedPoint=n,t.classed("selected",!0)}}()},{}]},{},[1]);